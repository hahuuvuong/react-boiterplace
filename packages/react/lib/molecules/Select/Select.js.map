{"version":3,"file":"Select.js","sources":["../../../src/molecules/Select/Select.tsx"],"sourcesContent":["import React, {\r\n  useState,\r\n  useRef,\r\n  useEffect,\r\n  KeyboardEventHandler,\r\n  createRef,\r\n} from \"react\";\r\n\r\nimport Text from \"../../atoms/Text\";\r\n\r\nconst KEY_CODES = {\r\n  ENTER: 13,\r\n  SPACE: 32,\r\n  DOWN_ARROW: 40,\r\n  ESC: 7,\r\n  UP_ARROW: 38,\r\n};\r\ninterface SelectOption {\r\n  label: string;\r\n  value: string;\r\n}\r\n\r\ninterface SelectProps {\r\n  label?: string;\r\n  onOptionSelected?: (option: SelectOption, optionIndex: number) => void;\r\n  options?: SelectOption[];\r\n}\r\nconst getNextOptionIndex = (\r\n  currentIndex: number | null,\r\n  option: Array<SelectOption>\r\n) => {\r\n  if (currentIndex === null) {\r\n    return 0;\r\n  }\r\n  if (currentIndex === option.length - 1) {\r\n    return 0;\r\n  }\r\n  return currentIndex + 1;\r\n};\r\nconst getPreviousOptionIndex = (\r\n  currentIndex: number | null,\r\n  option: Array<SelectOption>\r\n) => {\r\n  if (currentIndex === null) {\r\n    return 0;\r\n  }\r\n  if (currentIndex === 0) {\r\n    return option.length - 1;\r\n  }\r\n  return currentIndex - 1;\r\n};\r\nconst Select: React.FC<SelectProps> = ({\r\n  options = [],\r\n  label = \"Please select an option ...\",\r\n  onOptionSelected: handler,\r\n}) => {\r\n  const [isOpen, setIsOpen] = useState<Boolean>(false);\r\n\r\n  const [optionRefs, setOptionRefs] = useState<\r\n    React.RefObject<HTMLLIElement>[]\r\n  >([]);\r\n\r\n  const [selectedIndex, setSelectedIndex] = useState<null | number>(null);\r\n  const [highlightIndex, setHighlightIndex] = useState<null | number>(null);\r\n  const labelRef = useRef<HTMLButtonElement>(null);\r\n  const [overlayTop, setOverlayTop] = useState<number>(0);\r\n\r\n  useEffect(() => {\r\n    setOptionRefs(options.map((_) => createRef<HTMLLIElement>()));\r\n  }, [options.length]);\r\n\r\n  const onOptionSelected = (option: SelectOption, optionIndex: number) => {\r\n    setIsOpen(!isOpen);\r\n    handler && handler(option, optionIndex);\r\n    setSelectedIndex(optionIndex);\r\n    setIsOpen(false);\r\n  };\r\n\r\n  const onLabelClick = () => {\r\n    setIsOpen(!isOpen);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setOverlayTop((labelRef.current?.offsetHeight || 0) + 10);\r\n  }, [labelRef.current?.offsetHeight]);\r\n\r\n  let selectedOption = null;\r\n\r\n  if (selectedIndex !== null) {\r\n    selectedOption = options[selectedIndex];\r\n  }\r\n\r\n  const highlightItem = (optionIndex: number | null) => {\r\n    setHighlightIndex(optionIndex);\r\n  };\r\n  const onButtonDown: KeyboardEventHandler = (event) => {\r\n    event.preventDefault();\r\n\r\n    if (\r\n      [KEY_CODES.ENTER, KEY_CODES.SPACE, KEY_CODES.DOWN_ARROW].includes(\r\n        event.keyCode\r\n      )\r\n    ) {\r\n      setIsOpen(true);\r\n\r\n      highlightItem(0);\r\n    }\r\n  };\r\n  const onOptionKeydown: KeyboardEventHandler = (event) => {\r\n    event.preventDefault();\r\n    if (event.keyCode === KEY_CODES.ESC) {\r\n      setIsOpen(false);\r\n    }\r\n    if (event.keyCode === KEY_CODES.DOWN_ARROW) {\r\n      highlightItem(getNextOptionIndex(highlightIndex, options));\r\n    }\r\n    if (event.keyCode === KEY_CODES.UP_ARROW) {\r\n      highlightItem(getPreviousOptionIndex(highlightIndex, options));\r\n    }\r\n    if (event.keyCode === KEY_CODES.ENTER) {\r\n      onOptionSelected(options[highlightIndex!], highlightIndex!)\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (highlightIndex !== null && isOpen) {\r\n      const ref = optionRefs[highlightIndex];\r\n      if (ref && ref.current) {\r\n        ref.current.focus();\r\n      }\r\n    }\r\n  }, [isOpen, highlightIndex]);\r\n  return (\r\n    <div className={\"dse-select\"}>\r\n      <button\r\n      data-testid='DseSelectButton'\r\n        onKeyDown={onButtonDown}\r\n        ref={labelRef}\r\n        aria-controls=\"dse-select-list\"\r\n        aria-haspopup=\"true\"\r\n        aria-expanded={isOpen ? true : undefined}\r\n        className={\"dse-select__label\"}\r\n        onClick={() => onLabelClick()}\r\n      >\r\n        <Text>{selectedOption ? selectedOption.label : label}</Text>\r\n        <svg\r\n          className={`dse-select__caret ${\r\n            isOpen ? \"dse-select__caret--open\" : \"dse-select__caret--closed\"\r\n          }`}\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          height=\"1rem\"\r\n          width=\"1rem\"\r\n          viewBox=\"0 0 20 20\"\r\n          fill=\"currentColor\"\r\n        >\r\n          <path\r\n            fillRule=\"evenodd\"\r\n            d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\"\r\n            clipRule=\"evenodd\"\r\n          />\r\n        </svg>\r\n      </button>\r\n      {isOpen && (\r\n        <ul\r\n          style={{ top: overlayTop }}\r\n          aria-hidden={isOpen ? undefined : false}\r\n          className={\"dse-select__overlay\"}\r\n        >\r\n          {options.map((option, optionIndex) => {\r\n            const isSelected = selectedIndex === optionIndex;\r\n            const isHighlighted = highlightIndex === optionIndex;\r\n            const ref = optionRefs[optionIndex];\r\n            return (\r\n              <li\r\n                onKeyDown={onOptionKeydown}\r\n                ref={ref}\r\n                role='menuitemradio'\r\n                aria-label={option.label}\r\n                aria-checked={isSelected ? true : undefined}\r\n                tabIndex={isHighlighted ? -1 : 0}\r\n                onMouseEnter={() => highlightItem(optionIndex)}\r\n                onMouseLeave={() => highlightItem(null)}\r\n                className={`dse-select__option ${\r\n                  isSelected ? \"dse-select__option--selected\" : \"\"\r\n                } ${isHighlighted ? \"dse-select__option--highlighted\" : \"\"}\r\n                `}\r\n                onClick={() => onOptionSelected(option, optionIndex)}\r\n                key={option.value}\r\n              >\r\n                <Text>{option.label}</Text>\r\n                {isSelected && (\r\n                  <svg\r\n                    height=\"1rem\"\r\n                    width=\"1rem\"\r\n                    xmlns=\"http://www.w3.org/2000/svg\"\r\n                    className=\"h-5 w-5\"\r\n                    viewBox=\"0 0 20 20\"\r\n                    fill=\"currentColor\"\r\n                  >\r\n                    <path\r\n                      fillRule=\"evenodd\"\r\n                      d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\"\r\n                      clipRule=\"evenodd\"\r\n                    />\r\n                  </svg>\r\n                )}\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Select;\r\n"],"names":[],"mappings":"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"}